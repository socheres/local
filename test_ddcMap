//insert DDC>ixtheo-notation
function ddcIxtheo() {
	//map ddc 297 automatically
	var ddcMapIxth = {
		// 5010 : 6700
		"5010" : {
			"147" : "!372042996!",
			"148" : "!372042996!",
			"149" : "!372042996!",
			"230" : "!372043747!",
			"248" : "!372043763!",
			"249" : "!372043763!",
			"243" : "!372043763!",
			"242" : "!372043763!",
			"261,2" : "!372043801!",
			"292.07-292.08" : "!372043852!",
			"201,76369" : "!372043852!",
			"700,4823" : "!372043887!",
			"T3C--3823" : "!372043887!",
			"230,07" : "!372043895!",
			"215" : "!372043895!",
			"231,765" : "!372043895!",
			"220,832" : "!372043917!",
			"241,62" : "!372043917!",
			"261,1" : "!480735840!",
			"261,8" : "!480735840!",
			"230" : "!372044026!",
			"230,007" : "!372044042!",
			"230,07" : "!372044042!",
			"230,082" : "!372044077!",
			"230,089" : "!372044077!",
			"230,09" : "!372044077!",
			"202,082" : "!372044077!",
			"202,08996" : "!372044077!",
			"230,0464" : "!372044077!",
			"220" : "!372044085!",
			"221" : "!372044123!",
			"222" : "!372044123!",
			"223" : "!372044123!",
			"224" : "!372044123!",
			"229,91" : "!372044123!",
			"225" : "!372044131!",
			"226" : "!372044131!",
			"227" : "!372044131!",
			"228" : "!372044131!",
			"229,92" : "!372044131!",
			"229,93" : "!372044131!",
			"229,94" : "!372044131!",
			"229,91" : "!372044166!",
			"296,09014" : "!372044166!",
			"296,09015" : "!372044166!",
			"296,12" : "!372044166!",
			"296,14" : "!372044166!",
			"933" : "!372044182!",
			"220,9" : "!372044182!",
			"220,863" : "!372044182!",
			"220,86431" : "!372044182!",

			
		},
		"5401" : {
			"147" : "!372042996!",
			"148" : "!372042996!",
			"149" : "!372042996!",
			"230" : "!372043747!",
			"248" : "!372043763!",
			"249" : "!372043763!",
			"243" : "!372043763!",
			"242" : "!372043763!",
			"261,2" : "!372043801!",
			"292.07-292.08" : "!372043852!",
			"201,76369" : "!372043852!",
			"700,4823" : "!372043887!",
			"T3C--3823" : "!372043887!",
			"230,07" : "!372043895!",
			"215" : "!372043895!",
			"231,765" : "!372043895!",
			"220,832" : "!372043917!",
			"241,62" : "!372043917!",
			"261,1" : "!480735840!",
			"261,8" : "!480735840!",
			"230" : "!372044026!",
			"230,007" : "!372044042!",
			"230,07" : "!372044042!",
			"230,082" : "!372044077!",
			"230,089" : "!372044077!",
			"230,09" : "!372044077!",
			"202,082" : "!372044077!",
			"202,08996" : "!372044077!",
			"230,0464" : "!372044077!",
			"220" : "!372044085!",
			"221" : "!372044123!",
			"222" : "!372044123!",
			"223" : "!372044123!",
			"224" : "!372044123!",
			"229,91" : "!372044123!",
			"225" : "!372044131!",
			"226" : "!372044131!",
			"227" : "!372044131!",
			"228" : "!372044131!",
			"229,92" : "!372044131!",
			"229,93" : "!372044131!",
			"229,94" : "!372044131!",
			"229,91" : "!372044166!",
			"296,09014" : "!372044166!",
			"296,09015" : "!372044166!",
			"296,12" : "!372044166!",
			"296,14" : "!372044166!",
			"933" : "!372044182!",
			"220,9" : "!372044182!",
			"220,863" : "!372044182!",
			"220,86431" : "!372044182!",

		},
		//"5090" : {
		//	"" : "!372044131!",
		//	"" : "!372044131!",
		//}
		"5051" : {
			"147" : "!372042996!",
			"148" : "!372042996!",
			"149" : "!372042996!",
			"230" : "!372043747!",
			"248" : "!372043763!",
			"249" : "!372043763!",
			"243" : "!372043763!",
			"242" : "!372043763!",
			"261,2" : "!372043801!",
			"292.07-292.08" : "!372043852!",
			"201,76369" : "!372043852!",
			"700,4823" : "!372043887!",
			"T3C--3823" : "!372043887!",
			"230,07" : "!372043895!",
			"215" : "!372043895!",
			"231,765" : "!372043895!",
			"220,832" : "!372043917!",
			"241,62" : "!372043917!",
			"261,1" : "!480735840!",
			"261,8" : "!480735840!",
			"230" : "!372044026!",
			"230,007" : "!372044042!",
			"230,07" : "!372044042!",
			"230,082" : "!372044077!",
			"230,089" : "!372044077!",
			"230,09" : "!372044077!",
			"202,082" : "!372044077!",
			"202,08996" : "!372044077!",
			"230,0464" : "!372044077!",
			"220" : "!372044085!",
			"221" : "!372044123!",
			"222" : "!372044123!",
			"223" : "!372044123!",
			"224" : "!372044123!",
			"229,91" : "!372044123!",
			"225" : "!372044131!",
			"226" : "!372044131!",
			"227" : "!372044131!",
			"228" : "!372044131!",
			"229,92" : "!372044131!",
			"229,93" : "!372044131!",
			"229,94" : "!372044131!",
			"229,91" : "!372044166!",
			"296,09014" : "!372044166!",
			"296,09015" : "!372044166!",
			"296,12" : "!372044166!",
			"296,14" : "!372044166!",
			"933" : "!372044182!",
			"220,9" : "!372044182!",
			"220,863" : "!372044182!",
			"220,86431" : "!372044182!",

		}
	}

	//var escapeRegExp = function escapeRegExp(str) { return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&"); }

	//application.activeWindow.command("f snr casalin* abl ixbt", false);
	var str4801 = "";
	var str5010 = "";
	var str5401 = "";
	var str6700 = "";
	var str7100 = "";

	// Abruf des Sets + Nummer
	var strSet = "S" + application.activeWindow.getVariable("P3GSE");
	// Abruf der Setgröße (Sätze gesamt)
	var strCount = application.activeWindow.getVariable("P3GSZ");
	var count = parseInt(strCount);

	for (var i = 1; i <= count; i++) {
		var cmd = "k " + strSet + " " + i;
		application.activeWindow.command(cmd, false);
		str7100 = application.activeWindow.title.findTag("7100", 0, true, true, true);
		/*
		if (str6700 != "") {
			application.activeWindow.pressButton("Enter");
			continue;
		}
		*/
		for (var tag in ddcMapIxth) {
			var pair = ddcMapIxth[tag];
			strKey = application.activeWindow.title.findTag(tag, 0, true, true, true);
			//strKey = strKey.replace(/\[(.*?)\]$/g, "");
			
			var tag = strKey.substring(0, 4);
			var keys = strKey.substring(5);
			
		//	application.activeWindow.title.insertText("\ntag: " + tag);
		//	application.activeWindow.title.insertText("\nvalues: " + keys);
			var key_splits = keys.split(";");
			key_loop: for (var key_split in key_splits) {
				var current_key = key_splits[key_split].trim();
				
				// exact matching				
				/*for (var ddc_key in pair) {
					var value = pair[ddc_key];									
					if (current_key == ddc_key) {
						str4801 = application.activeWindow.title.findTag("4801", 0, true, true, true);
						str6700 = application.activeWindow.title.findTag("6700", 0, true, true, true);
						if (str7100.match(/Tü 135/g) && !str4801 && !str6700) {
							application.activeWindow.title.endOfBuffer(false);
							application.activeWindow.title.insertText("\n4801 6700  maschinelles Mapping DDC " + ddc_key + "> " + value);
							application.activeWindow.title.insertText("\n6700" + value);
							continue key_loop;
						} else if (str7100.match(/Tü 135/g) && str4801 && !str6700){
							application.activeWindow.title.endOfBuffer(false);
							application.activeWindow.title.findTag("4801", 0, true, true, true);
							application.activeWindow.title.insertText(str4801 + ". - 6700  maschinelles Mapping DDC " + ddc_key + "> " + value);
							continue key_loop;
						} else if (str7100.match(/Tü 135/g) && !str4801 && str6700){
							application.activeWindow.title.endOfBuffer(false);
							application.activeWindow.title.findTag("4801", 0, true, true, true);
							application.activeWindow.title.insertText("\n4801 6700  maschinelles Mapping DDC " + ddc_key + "> " + value);
							application.activeWindow.title.insertText("\n6700 " + value);
							continue key_loop;
						} else if (str7100.match(/Tü 135/g) && str4801 && str6700){
							application.activeWindow.title.endOfBuffer(false);
							application.activeWindow.title.findTag("4801", 0, true, true, true);
							application.activeWindow.title.insertText(str4801 + ". - 6700  maschinelles Mapping DDC " + ddc_key + "> " + value + "\n6700 " + value);
							continue key_loop;
						} else if (!str7100.match(/Tü 135/g)) {
							application.activeWindow.title.endOfBuffer(false);
							application.activeWindow.title.insertText("\nE*  l01\n7100$jn\n6700 " + value + " \n4801 6700 maschinelles Mapping DDC " + ddc_key + "> " + value);
							continue key_loop;
						}
					}
				}*/
			
				
				// partial matching
				for (var ddc_key in pair) {
					var value = pair[ddc_key];
									
				//	application.activeWindow.title.insertText("\ncurrent key: " + current_key);
				//	application.activeWindow.title.insertText("\nddc key: " + ddc_key);
				//	application.activeWindow.title.insertText("\nppn: " + value);
					if (current_key.startsWith(ddc_key)) {
						str4801 = application.activeWindow.title.findTag("4801", 0, true, true, true);
						str6700 = application.activeWindow.title.findTag("6700", 0, true, true, true);
							if (str7100.match(/Tü 135/g) && !str4801 && !str6700) {
							application.activeWindow.title.endOfBuffer(false);
							application.activeWindow.title.insertText("\n4801 6700  maschinelles Mapping DDC " + ddc_key + "> " + value);
							application.activeWindow.title.insertText("\n6700" + value);
							continue key_loop;
						} else if (str7100.match(/Tü 135/g) && str4801 && !str6700){
							application.activeWindow.title.endOfBuffer(false);
							application.activeWindow.title.findTag("4801", 0, true, true, true);
							application.activeWindow.title.insertText(str4801 + ". - 6700  maschinelles Mapping " + ddc_key + "> " + value);
							continue key_loop;
						} else if (str7100.match(/Tü 135/g) && !str4801 && str6700){
							application.activeWindow.title.endOfBuffer(false);
							application.activeWindow.title.findTag("4801", 0, true, true, true);
							application.activeWindow.title.insertText("\n4801 6700  maschinelles Mapping DDC " + ddc_key + "> " + value);
							application.activeWindow.title.insertText("\n6700 " + value);
							continue key_loop;
						} else if (str7100.match(/Tü 135/g) && str4801 && str6700){
							application.activeWindow.title.endOfBuffer(false);
							application.activeWindow.title.findTag("4801", 0, true, true, true);
							application.activeWindow.title.insertText(str4801 + ". - 6700  maschinelles Mapping DDC " + ddc_key + "> " + value + "\n6700 " + value);
							continue key_loop;
						} else if (!str7100.match(/Tü 135/g)) {
							application.activeWindow.title.endOfBuffer(false);
							application.activeWindow.title.insertText("\nE*  l01\n7100$jn\n6700 " + value + " \n4801 6700 maschinelles Mapping DDC " + ddc_key + "> " + value);
							continue key_loop;
						}
					}
				}
			}
		}
		application.activeWindow.pressButton("Enter");
	}
}
