//kim, timotheus chang whae | Madeesh
//30.01.2019
function ddcIxTheoMatchHierarchy(str7100, notationList, ddcKey, partialMatching) {
	for (var notationHierarchyEntry in notationList) {
		var notation2ppnMap = notationList[notationHierarchyEntry];
		for (var notationKey in notation2ppnMap) {
			var notationPPN = notation2ppnMap[notationKey];

			if ((!partialMatching && notationKey === ddcKey) || (partialMatching && ddcKey.startsWith(notationKey))) {
				var str4801 = application.activeWindow.title.findTag("4801", 0, true, true, true);
				var str6700 = application.activeWindow.title.findTag("6700", 0, true, true, true);

				if (str7100.match(/Tü 135/g)) {
					application.activeWindow.title.endOfBuffer(false);

					if (!str4801 && !str6700) {
						// add both 4801 and 6700 entries
						application.activeWindow.title.insertText("\n4801 6700  maschinelles Mapping DDC " + notationKey + " > " + notationPPN);
						application.activeWindow.title.insertText("\n6700 " + notationPPN.replace(/ /g, '\n6700'));
					} else if (str4801 && !str6700) {
						// update exisiting 4801 entry and add new 6700 entries
						application.activeWindow.title.findTag("4801", 0, true, true, true);
						application.activeWindow.title.insertText(str4801 + ". - 6700  maschinelles Mapping DDC " + notationKey + " > " + notationPPN);
						application.activeWindow.title.insertText("\n6700 " + notationPPN.replace(/ /g, '\n6700'));
					} else if (!str4801 && str6700) {
						;// do nothing
					} else if (str4801 && str6700) {
						;// do nothing
					}
				} else {
					application.activeWindow.title.insertText("\nE* l01\n7100$jn\n6700 " + ppn.replace(/ /g, '\n6700') + " \n4801 6700 maschinelles Mapping DDC " + notationKey + " > " + notationPPN);
				}

				return true;
			}
		}
	}

	return false;
};


//insert DDC>ixtheo-notation
function ddcIxtheo_test() {
	// Um eine Hierarchie zu simulieren (bei Partial-Matching), müssen die Kategorien abstigend von Genauigkeit geprüft werden
	// d.h die spezifizierten Notationen müssen vor den allgemeineren berücksichtigt werden
	// Von daher brauchen wir eine Mapping-Tabelle für jeweilige Notation. Die Struktur folgt:
	/*
		Wurzel-Map: {
			'<Feld Nr.>' : [
				// Wird als erste ausgewertet. Die Notationen müssen spezifischer als die Zweite sein.
				{
					'<Notation>' : '<PPN>',
					usw...
				},
				// Wird als zweite ausgewertet. Die Notationen müssen allgemeiner als die Erste sein.
				{
					'<Notation>' : '<PPN>',
					usw...
				},
				usw...
			],
			usw...
		}
		<PPN> besteht aus einzelnen PPNs oder mehrere PPNs getrennt durch ein Leerzeichen

		Beispiel:
		ddcMap = {
			'5010' : [
				{
					'220.111' : '!1234567890!',
					'220.222' : '!1234567890!',
					'220.333' : '!1234567890!',
				},
				{
					'220.11' : '!1234567890!',
					'220.22' : '!1234567890!',
					'220.33' : '!1234567890!',
				},
				{
					'220' : '!1234567890!',
					'220' : '!1234567890!',
					'220' : '!1234567890!',
				},
			],
			...
		}
	*/
	var ddcMap = {
		'5010': [
			{
				'251.00882819' : '!372050379!',//KDF
				'259.41969792' : '!372053270!',//RK
				'253.02854678' : '!372053270!',//RK
			},
			{
				'261.8088282' : '!372049834!',//KDB
				'259.4196998' : '!372053270!',//RK
			},
			{
				'230.073342' : '!37205014X!',//KDE
				'259.086947' : '!372053270!',//RK
				'259.086949' : '!372053270!',//RK
				'259.419892' : '!372053270!',//RK
				
			},
			{
				'201.76369' : '!372043852!',//CD
				'202.08996' : '!372044077!',//FD
				'220.86431' : '!372044182!',//HH
				'230.07319' : '!372050379!',//KDF
				'241.64957' : '!480736588!',//NCJ
				'262.98342' : '!37205014X!',//KDE
				'264.01902' : '!372050379!',//KDF
				'264.02036' : '!372049834!',//KDB
				'264.02099' : '!372049834!',//KDB
				'267.18342' : '!37205014X!',//KDE
				'296.09014' : '!372044166!',//HD
				'296.09015' : '!372044166!',//HD
				
			},
			{
				'230.0464' : '!372044077!',//FD
				'230.0733' : '!37205014X!',//KDE
				'241.0419' : '!372050379!',//KDF
				'241.0448' : '!372049931!',//KDC
				'241.6765' : '!372052967!',//NCF
				'241.6976' : '!372052967!',//NCF
				'248.4819' : '!372050379!',//KDF
				'248.4848' : '!372049931!',//KDC
				'254.0342' : '!37205014X!',//KDE
				'255.9819' : '!372050379!',//KDF
				'262.0011' : '!372050603!',//KDJ
				'262.0342' : '!37205014X!',//KDE
				'262.9804' : '!372050042!',//KDD
				'262.9819' : '!372050379!',//KDF
				'262.9841' : '!372050042!',//KDD
				'262.9842' : '!372050042! !372050476!',//KDD KDG
				'262.9848' : '!372049931!',//KDC
				'262.9897' : '!372050476!',//KDG
				'267.1804' : '!372050042!',//KDD
				'267.1819' : '!372050379!',//KDF
				'267.1841' : '!372050042!',//KDD
				'267.1842' : '!372050042! !372050476!',//KDD KDG
				'267.1896' : '!372050476!',//KDG
				'267.1897' : '!372050476!',//KDG
				'268.8342' : '!37205014X!',//KDE
				'271.9819' : '!372050379!',//KDF
				'282.0922' : '!372049494!',//KCB
				'700.4823' : '!372043887!',//CE
				
			},
			{
				'202.082' : '!372044077!',//FD
				'220.832' : '!372043917!',//CG
				'220.863' : '!372044182!',//HH
				'230.007' : '!372044042!',//FB
				'230.082' : '!372044077!',//FD
				'230.089' : '!372044077!',//FD
				'231.765' : '!372043895!',//CF
				'241.042' : '!372049834!',//KDB
				'241.043' : '!37205014X!',//KDE
				'241.691' : '!372052983!',//NCG
				'241.693' : '!372052983!',//NCG
				'241.694' : '!372052983!',//NCG
				'248.242' : '!372049834!',//KDB
				'248.482' : '!372049834!',//KDB
				'248.483' : '!37205014X!',//KDE
				'248.894' : '!372049443!',//KCA
				'254.019' : '!372050379!',//KDF
				'254.048' : '!372049931!',//KDC
				'255.819' : '!372050379!',//KDF
				'262.019' : '!372050379!',//KDF
				'262.041' : '!372050042!',//KDD
				'262.042' : '!372050042! !372050476!',//KDD KDG
				'262.048' : '!372049931!',//KDC
				'262.096' : '!372050476!',//KDG
				'262.097' : '!372050476!',//KDG
				'262.519' : '!372050379!',//KDF
				'262.541' : '!372050042!',//KDD
				'262.596' : '!372050476!',//KDG
				'262.983' : '!37205014X!',//KDE
				'262.985' : '!372050042! !372050476!',//KDD KDG
				'262.986' : '!372050042! !372050476!',//KDD KDG
				'262.987' : '!372050042! !372050476!',//KDD KDG
				'264.019' : '!372050379!',//KDF
				'264.041' : '!372050042!',//KDD
				'264.042' : '!372050042! !372050476!',//KDD KDG
				'264.048' : '!372049931!',//KDC
				'264.096' : '!372050476!',//KDG
				'264.097' : '!372050476!',//KDG
				'267.183' : '!37205014X!',//KDE KDD
				'267.185' : '!372050042! !372050476!',//KDD
				'267.186' : '!372050042! !372050476!',//KDD KDG
				'267.187' : '!372050042! !372050476!',//KDD KDG
				'268.804' : '!372050042!',//KDD
				'268.819' : '!372050379!',//KDF
				'268.841' : '!372050042!',//KDD
				'268.842' : '!372050042! !372050476!',//KDD KDG
				'268.848' : '!372049931!',//KDC
				'268.897' : '!372050476!',//KDG
				'271.819' : '!372050379!',//KDF
				'281.947' : '!372050379!',//KDF
				'941.105' : '!372044603!',//KAG
				'266.022' : '!37205322X!',//RH
				'261.832' : '!372053270!',//RK
				
			},
			{
				'229.91' : '!372044123! !372044166!',//HB HD
				'229.92' : '!372044131!',//HC
				'229.93' : '!372044131!',//HC
				'229.94' : '!372044131!',//HC CF
				'230.07' : '!372043895! !372044042!',//CF
				'230.09' : '!372044077!',//FD
				'230.19' : '!372050379!',//KDF
				'230.48' : '!372049931!',//KDC
				'238.48' : '!372049931!',//KDC
				'241.62' : '!372043917! !372052851!',//CG NCD
				'241.66' : '!372052967! !480736553!',//NCF NCH
				'241.67' : '!372052835!',//NCC
				'254.02' : '!372049834!',//KDB
				'254.03' : '!37205014X!',//KDE
				'262.02' : '!372049834!',//KDB
				'262.03' : '!37205014X!',//KDE KDD
				'262.05' : '!372050042! !372050476!',//KDD
				'262.06' : '!372050042! !372050476!',//KDD KDG
				'262.07' : '!372050042! !372050476!',//KDD KDG
				'262.13' : '!372049494!',//KCB
				'262.52' : '!372049834!',//KDB
				'262.53' : '!37205014X!',//KDE
				'262.55' : '!372050042!',//KDD
				'262.56' : '!372050042! !372050476!',//KDD KDG
				'262.92' : '!372049834!',//KDB
				'264.02' : '!372049834!',//KDB
				'264.03' : '!37205014X!',//KDE
				'264.05' : '!372050476!',//KDG
				'264.06' : '!372050042! !372050476!',//KDD KDG
				'264.07' : '!372050042! !372050476!',//KDD KDG
				'266.19' : '!372050379!',//KDF
				'266.41' : '!372050042!',//KDD
				'266.42' : '!372050042! !372050476!',//KDD
				'266.48' : '!372049931!',//KDC
				'266.96' : '!372050476!',//KDG
				'266.97' : '!372050476!',//KDG
				'268.82' : '!372049834!',//KDB
				'268.83' : '!37205014X!',//KDE
				'268.85' : '!372050042! !372050476!',//KDD KDG
				'268.86' : '!372050042! !372050476!',//KDD KDG
				'268.87' : '!372050042! !372050476!',//KDD KDG
				'270.82' : '!372044646!',//KAJ
				'270.83' : '!372044646!',//KAJ
				'274.41' : '!372044883!',//KBF
				'274.42' : '!372044883!',//KBF
				'274.43' : '!372044727!',//KBB
				'274.44' : '!372044980!',//KBG
				'274.45' : '!372048781!',//KBJ
				'274.46' : '!372044999!',//KBH
				'274.47' : '!37204882X!',//KBK
				'274.48' : '!372044786!',//KBE
				'275.53' : '!372048889!',//KBL
				'275.54' : '!372048889!',//KBL
				'275.55' : '!372048889!',//KBL
				'279.93' : '!372049354!',//KBS
				'279.94' : '!372049354!',//KBS
				'279.95' : '!372049354!',//KBS
				'279.96' : '!372049354!',//KBS
				'283.42' : '!37205014X!',//KDE
				'292.07' : '!372043852!',//CD
				'292.08' : '!372043852!',//CD
				'296.12' : '!372044166!',//HD
				'296.14' : '!372044166!',//HD
				'296.48' : '!372049656!',//KCD
				'940.23' : '!372044603!',//KAG
				'943.03' : '!372044603!',//KAG
				'231.74' : '!372051324!',//NBB
				'232.91' : '!37205224X!',//NBJ
				'234.16' : '!372052436!',//NBP
				'261.52' : '!37205322X!',//RH
				'259.44' : '!372053270!',//RK
				
			},
			{
				'203.5' : '!372049656!',//KCD
				'220.9' : '!372044182!',//HH
				'230.2' : '!372049834!',//KDB
				'230.3' : '!37205014X!',//KDE
				'235.2' : '!372049656!',//KCD
				'238.2' : '!372049834!',//KDB
				'238.3' : '!37205014X!',//KDE
				'261.1' : '!480735840!',//CH
				'261.2' : '!372043801!',//CC
				'261.8' : '!480735840!',//CH
				'262.3' : '!372049494!',//KCB
				'262.5' : '!372049613!',//KCC
				'266.2' : '!372049834!',//KDB
				'266.3' : '!37205014X!',//KDE
				'266.5' : '!372050042! !372050476!',//KDD KDG
				'266.6' : '!372050042! !372050476!',//KDD KDG
				'266.7' : '!372050042! !372050476!',//KDD KDG
				'268.8' : '!372049729!',//KDA
				'270.2' : '!372044336! !37204445X!',//KAC KAD
				'270.3' : '!372044336! !37204445X! !372044468!',//KAC KAD KAE
				'270.4' : '!372044336! !372044468!',//KAC KAE
				'270.5' : '!372044336! !372044530!',//KAC KAF
				'270.6' : '!372044603!',//KAG
				'270.7' : '!37204462X!',//KAH
				'270.8' : '!37204462X!',//KAH
				'272.7' : '!372049834!',//KDB
				'274.4' : '!372044697!',//KBA
				'274.8' : '!372049273!',//KBR
				'281.1' : '!37204428X!',//KAB
				'281.2' : '!37204428X!',//KAB
				'281.3' : '!37204428X!',//KAB
				'281.7' : '!372050379!',//KDF
				'281.9' : '!372050379!',//KDF
				'284.1' : '!372050042!',//KDD
				'284.2' : '!372050042!',//KDD
				'284.5' : '!372050476!',//KDG
				'284.8' : '!372049834!',//KDB
				'289.1' : '!480736162!',//KDH
				'289.3' : '!480736162!',//KDH
				'289.4' : '!480736162!',//KDH
				'289.5' : '!480736162!',//KDH
				'289.8' : '!480736162!',//KDH
				'289.9' : '!480736162!',//KDH
				'233.1' : '!372051537!',//NBD
				'231.3' : '!372051960!',//NBG
				'214.8' : '!372052363!',//NBL
				'231.5' : '!372052363!',//NBL
				'234.9' : '!372052363!',//NBL
				'234.7' : '!37205238X!',//NBM
				'264.2' : '!372053106!',//RD
				'269.2' : '!37205322X!',//RH
				'254.3' : '!37205322X!',//RH
				
			},
			{
				'215' : '!372043895!',//CF
				'220' : '!372044085!',//HA
				'221' : '!372044123!',//HB
				'222' : '!372044123!',//HB
				'223' : '!372044123!',//HB
				'224' : '!372044123!',//HB
				'225' : '!372044131!',//HC
				'226' : '!372044131!',//HC
				'227' : '!372044131!',//HC
				'228' : '!372044131!',//HC
				'230' : '!372043747!',//CA
				'230' : '!372044026!',//FA
				'242' : '!372043763!',//CB
				'243' : '!372043763!',//CB
				'248' : '!372043763!',//CB
				'249' : '!372043763!',//CB
				'255' : '!372049443!',//KCA
				'270' : '!372044220!',//KAA
				'271' : '!372049443!',//KCA
				'274' : '!372044697!',//KBA
				'275' : '!372048935!',//KBM
				'275' : '!372048935!',//KBM
				'276' : '!372049028!',//KBN
				'277' : '!372049109! !372049222!',//KBP KBQ
				'278' : '!372049109!',//KBP
				'282' : '!372049834!',//KDB
				'283' : '!37205014X!',//KDE
				'287' : '!372050042!',//KDD
				'933' : '!372044182!',//HH
				'231' : '!372050999!',//NBA
				'232' : '!372050999!',//NBA
				'233' : '!372050999!',//NBA
				'234' : '!372050999!',//NBA
				'235' : '!372050999!',//NBA
				'236' : '!372050999!',//NBA
				'238' : '!372050999!',//NBA
				'231' : '!372051502!',//NBC
				'233' : '!372051685!',//NBE
				'232' : '!372051782!',//NBF
				'253' : '!372052126!',//NBH
				'254' : '!372052126!',//NBH
				'234' : '!372052320!',//NBK
				'262' : '!37205241X!',//NBN
				'265' : '!372052436!',//NBP
				'236' : '!372052444!',//NBQ
				'248' : '!372053009!',//RA
				'250' : '!372053009!',//RA
				'251' : '!372053009! !372053130!',//RA
				'252' : '!372053009!',//RA
				'253' : '!372053009!',//RA
				'254' : '!372053009!',//RA
				'264' : '!372053009!',//RA
				'265' : '!372053009!',//RA
				'268' : '!372053009!',//RA
				'269' : '!372053009!',//RA
				'254' : '!372053025!',//RB
				'269' : '!372053025!',//RB
				'264' : '!372053068!',//RC
				'252' : '!372053130!',//RE
				'268' : '!372053157!',//RF
				'253' : '!37205319X!',//RG
				'259' : '!37205319X!',//RG
				'266' : '!372053246!',//RJ
				
			},
		],
				'5401': [
			{
				'251.00882819' : '!372050379!',//KDF
				'259.41969792' : '!372053270!',//RK
				'253.02854678' : '!372053270!',//RK
			},
			{
				'261.8088282' : '!372049834!',//KDB
				'259.4196998' : '!372053270!',//RK
			},
			{
				'230.073342' : '!37205014X!',//KDE
				'259.086947' : '!372053270!',//RK
				'259.086949' : '!372053270!',//RK
				'259.419892' : '!372053270!',//RK
				
			},
			{
				'201.76369' : '!372043852!',//CD
				'202.08996' : '!372044077!',//FD
				'220.86431' : '!372044182!',//HH
				'230.07319' : '!372050379!',//KDF
				'241.64957' : '!480736588!',//NCJ
				'262.98342' : '!37205014X!',//KDE
				'264.01902' : '!372050379!',//KDF
				'264.02036' : '!372049834!',//KDB
				'264.02099' : '!372049834!',//KDB
				'267.18342' : '!37205014X!',//KDE
				'296.09014' : '!372044166!',//HD
				'296.09015' : '!372044166!',//HD
				
			},
			{
				'230.0464' : '!372044077!',//FD
				'230.0733' : '!37205014X!',//KDE
				'241.0419' : '!372050379!',//KDF
				'241.0448' : '!372049931!',//KDC
				'241.6765' : '!372052967!',//NCF
				'241.6976' : '!372052967!',//NCF
				'248.4819' : '!372050379!',//KDF
				'248.4848' : '!372049931!',//KDC
				'254.0342' : '!37205014X!',//KDE
				'255.9819' : '!372050379!',//KDF
				'262.0011' : '!372050603!',//KDJ
				'262.0342' : '!37205014X!',//KDE
				'262.9804' : '!372050042!',//KDD
				'262.9819' : '!372050379!',//KDF
				'262.9841' : '!372050042!',//KDD
				'262.9842' : '!372050042! !372050476!',//KDD KDG
				'262.9848' : '!372049931!',//KDC
				'262.9897' : '!372050476!',//KDG
				'267.1804' : '!372050042!',//KDD
				'267.1819' : '!372050379!',//KDF
				'267.1841' : '!372050042!',//KDD
				'267.1842' : '!372050042! !372050476!',//KDD KDG
				'267.1896' : '!372050476!',//KDG
				'267.1897' : '!372050476!',//KDG
				'268.8342' : '!37205014X!',//KDE
				'271.9819' : '!372050379!',//KDF
				'282.0922' : '!372049494!',//KCB
				'700.4823' : '!372043887!',//CE
				
			},
			{
				'202.082' : '!372044077!',//FD
				'220.832' : '!372043917!',//CG
				'220.863' : '!372044182!',//HH
				'230.007' : '!372044042!',//FB
				'230.082' : '!372044077!',//FD
				'230.089' : '!372044077!',//FD
				'231.765' : '!372043895!',//CF
				'241.042' : '!372049834!',//KDB
				'241.043' : '!37205014X!',//KDE
				'241.691' : '!372052983!',//NCG
				'241.693' : '!372052983!',//NCG
				'241.694' : '!372052983!',//NCG
				'248.242' : '!372049834!',//KDB
				'248.482' : '!372049834!',//KDB
				'248.483' : '!37205014X!',//KDE
				'248.894' : '!372049443!',//KCA
				'254.019' : '!372050379!',//KDF
				'254.048' : '!372049931!',//KDC
				'255.819' : '!372050379!',//KDF
				'262.019' : '!372050379!',//KDF
				'262.041' : '!372050042!',//KDD
				'262.042' : '!372050042! !372050476!',//KDD KDG
				'262.048' : '!372049931!',//KDC
				'262.096' : '!372050476!',//KDG
				'262.097' : '!372050476!',//KDG
				'262.519' : '!372050379!',//KDF
				'262.541' : '!372050042!',//KDD
				'262.596' : '!372050476!',//KDG
				'262.983' : '!37205014X!',//KDE
				'262.985' : '!372050042! !372050476!',//KDD KDG
				'262.986' : '!372050042! !372050476!',//KDD KDG
				'262.987' : '!372050042! !372050476!',//KDD KDG
				'264.019' : '!372050379!',//KDF
				'264.041' : '!372050042!',//KDD
				'264.042' : '!372050042! !372050476!',//KDD KDG
				'264.048' : '!372049931!',//KDC
				'264.096' : '!372050476!',//KDG
				'264.097' : '!372050476!',//KDG
				'267.183' : '!37205014X!',//KDE KDD
				'267.185' : '!372050042! !372050476!',//KDD
				'267.186' : '!372050042! !372050476!',//KDD KDG
				'267.187' : '!372050042! !372050476!',//KDD KDG
				'268.804' : '!372050042!',//KDD
				'268.819' : '!372050379!',//KDF
				'268.841' : '!372050042!',//KDD
				'268.842' : '!372050042! !372050476!',//KDD KDG
				'268.848' : '!372049931!',//KDC
				'268.897' : '!372050476!',//KDG
				'271.819' : '!372050379!',//KDF
				'281.947' : '!372050379!',//KDF
				'941.105' : '!372044603!',//KAG
				'266.022' : '!37205322X!',//RH
				'261.832' : '!372053270!',//RK
				
			},
			{
				'229.91' : '!372044123! !372044166!',//HB HD
				'229.92' : '!372044131!',//HC
				'229.93' : '!372044131!',//HC
				'229.94' : '!372044131!',//HC CF
				'230.07' : '!372043895! !372044042!',//CF
				'230.09' : '!372044077!',//FD
				'230.19' : '!372050379!',//KDF
				'230.48' : '!372049931!',//KDC
				'238.48' : '!372049931!',//KDC
				'241.62' : '!372043917! !372052851!',//CG NCD
				'241.66' : '!372052967! !480736553!',//NCF NCH
				'241.67' : '!372052835!',//NCC
				'254.02' : '!372049834!',//KDB
				'254.03' : '!37205014X!',//KDE
				'262.02' : '!372049834!',//KDB
				'262.03' : '!37205014X!',//KDE KDD
				'262.05' : '!372050042! !372050476!',//KDD
				'262.06' : '!372050042! !372050476!',//KDD KDG
				'262.07' : '!372050042! !372050476!',//KDD KDG
				'262.13' : '!372049494!',//KCB
				'262.52' : '!372049834!',//KDB
				'262.53' : '!37205014X!',//KDE
				'262.55' : '!372050042!',//KDD
				'262.56' : '!372050042! !372050476!',//KDD KDG
				'262.92' : '!372049834!',//KDB
				'264.02' : '!372049834!',//KDB
				'264.03' : '!37205014X!',//KDE
				'264.05' : '!372050476!',//KDG
				'264.06' : '!372050042! !372050476!',//KDD KDG
				'264.07' : '!372050042! !372050476!',//KDD KDG
				'266.19' : '!372050379!',//KDF
				'266.41' : '!372050042!',//KDD
				'266.42' : '!372050042! !372050476!',//KDD
				'266.48' : '!372049931!',//KDC
				'266.96' : '!372050476!',//KDG
				'266.97' : '!372050476!',//KDG
				'268.82' : '!372049834!',//KDB
				'268.83' : '!37205014X!',//KDE
				'268.85' : '!372050042! !372050476!',//KDD KDG
				'268.86' : '!372050042! !372050476!',//KDD KDG
				'268.87' : '!372050042! !372050476!',//KDD KDG
				'270.82' : '!372044646!',//KAJ
				'270.83' : '!372044646!',//KAJ
				'274.41' : '!372044883!',//KBF
				'274.42' : '!372044883!',//KBF
				'274.43' : '!372044727!',//KBB
				'274.44' : '!372044980!',//KBG
				'274.45' : '!372048781!',//KBJ
				'274.46' : '!372044999!',//KBH
				'274.47' : '!37204882X!',//KBK
				'274.48' : '!372044786!',//KBE
				'275.53' : '!372048889!',//KBL
				'275.54' : '!372048889!',//KBL
				'275.55' : '!372048889!',//KBL
				'279.93' : '!372049354!',//KBS
				'279.94' : '!372049354!',//KBS
				'279.95' : '!372049354!',//KBS
				'279.96' : '!372049354!',//KBS
				'283.42' : '!37205014X!',//KDE
				'292.07' : '!372043852!',//CD
				'292.08' : '!372043852!',//CD
				'296.12' : '!372044166!',//HD
				'296.14' : '!372044166!',//HD
				'296.48' : '!372049656!',//KCD
				'940.23' : '!372044603!',//KAG
				'943.03' : '!372044603!',//KAG
				'231.74' : '!372051324!',//NBB
				'232.91' : '!37205224X!',//NBJ
				'234.16' : '!372052436!',//NBP
				'261.52' : '!37205322X!',//RH
				'259.44' : '!372053270!',//RK
				
			},
			{
				'203.5' : '!372049656!',//KCD
				'220.9' : '!372044182!',//HH
				'230.2' : '!372049834!',//KDB
				'230.3' : '!37205014X!',//KDE
				'235.2' : '!372049656!',//KCD
				'238.2' : '!372049834!',//KDB
				'238.3' : '!37205014X!',//KDE
				'261.1' : '!480735840!',//CH
				'261.2' : '!372043801!',//CC
				'261.8' : '!480735840!',//CH
				'262.3' : '!372049494!',//KCB
				'262.5' : '!372049613!',//KCC
				'266.2' : '!372049834!',//KDB
				'266.3' : '!37205014X!',//KDE
				'266.5' : '!372050042! !372050476!',//KDD KDG
				'266.6' : '!372050042! !372050476!',//KDD KDG
				'266.7' : '!372050042! !372050476!',//KDD KDG
				'268.8' : '!372049729!',//KDA
				'270.2' : '!372044336! !37204445X!',//KAC KAD
				'270.3' : '!372044336! !37204445X! !372044468!',//KAC KAD KAE
				'270.4' : '!372044336! !372044468!',//KAC KAE
				'270.5' : '!372044336! !372044530!',//KAC KAF
				'270.6' : '!372044603!',//KAG
				'270.7' : '!37204462X!',//KAH
				'270.8' : '!37204462X!',//KAH
				'272.7' : '!372049834!',//KDB
				'274.4' : '!372044697!',//KBA
				'274.8' : '!372049273!',//KBR
				'281.1' : '!37204428X!',//KAB
				'281.2' : '!37204428X!',//KAB
				'281.3' : '!37204428X!',//KAB
				'281.7' : '!372050379!',//KDF
				'281.9' : '!372050379!',//KDF
				'284.1' : '!372050042!',//KDD
				'284.2' : '!372050042!',//KDD
				'284.5' : '!372050476!',//KDG
				'284.8' : '!372049834!',//KDB
				'289.1' : '!480736162!',//KDH
				'289.3' : '!480736162!',//KDH
				'289.4' : '!480736162!',//KDH
				'289.5' : '!480736162!',//KDH
				'289.8' : '!480736162!',//KDH
				'289.9' : '!480736162!',//KDH
				'233.1' : '!372051537!',//NBD
				'231.3' : '!372051960!',//NBG
				'214.8' : '!372052363!',//NBL
				'231.5' : '!372052363!',//NBL
				'234.9' : '!372052363!',//NBL
				'234.7' : '!37205238X!',//NBM
				'264.2' : '!372053106!',//RD
				'269.2' : '!37205322X!',//RH
				'254.3' : '!37205322X!',//RH
				
			},
			{
				'215' : '!372043895!',//CF
				'220' : '!372044085!',//HA
				'221' : '!372044123!',//HB
				'222' : '!372044123!',//HB
				'223' : '!372044123!',//HB
				'224' : '!372044123!',//HB
				'225' : '!372044131!',//HC
				'226' : '!372044131!',//HC
				'227' : '!372044131!',//HC
				'228' : '!372044131!',//HC
				'230' : '!372043747!',//CA
				'230' : '!372044026!',//FA
				'242' : '!372043763!',//CB
				'243' : '!372043763!',//CB
				'248' : '!372043763!',//CB
				'249' : '!372043763!',//CB
				'255' : '!372049443!',//KCA
				'270' : '!372044220!',//KAA
				'271' : '!372049443!',//KCA
				'274' : '!372044697!',//KBA
				'275' : '!372048935!',//KBM
				'275' : '!372048935!',//KBM
				'276' : '!372049028!',//KBN
				'277' : '!372049109! !372049222!',//KBP KBQ
				'278' : '!372049109!',//KBP
				'282' : '!372049834!',//KDB
				'283' : '!37205014X!',//KDE
				'287' : '!372050042!',//KDD
				'933' : '!372044182!',//HH
				'231' : '!372050999!',//NBA
				'232' : '!372050999!',//NBA
				'233' : '!372050999!',//NBA
				'234' : '!372050999!',//NBA
				'235' : '!372050999!',//NBA
				'236' : '!372050999!',//NBA
				'238' : '!372050999!',//NBA
				'231' : '!372051502!',//NBC
				'233' : '!372051685!',//NBE
				'232' : '!372051782!',//NBF
				'253' : '!372052126!',//NBH
				'254' : '!372052126!',//NBH
				'234' : '!372052320!',//NBK
				'262' : '!37205241X!',//NBN
				'265' : '!372052436!',//NBP
				'236' : '!372052444!',//NBQ
				'248' : '!372053009!',//RA
				'250' : '!372053009!',//RA
				'251' : '!372053009! !372053130!',//RA
				'252' : '!372053009!',//RA
				'253' : '!372053009!',//RA
				'254' : '!372053009!',//RA
				'264' : '!372053009!',//RA
				'265' : '!372053009!',//RA
				'268' : '!372053009!',//RA
				'269' : '!372053009!',//RA
				'254' : '!372053025!',//RB
				'269' : '!372053025!',//RB
				'264' : '!372053068!',//RC
				'252' : '!372053130!',//RE
				'268' : '!372053157!',//RF
				'253' : '!37205319X!',//RG
				'259' : '!37205319X!',//RG
				'266' : '!372053246!',//RJ
				
			},
		],
		
	};

	var str4801 = "";
	var str5010 = "";
	var str5401 = "";
	var str5051 = "";
	var str6700 = "";
	var str7100 = "";


	// Abruf des Sets + Nummer
	var strSet = "S" + application.activeWindow.getVariable("P3GSE");
	// Abruf der Setgröße (Sätze gesamt)
	var strCount = application.activeWindow.getVariable("P3GSZ");
	var count = parseInt(strCount);

	for (var i = 1; i <= count; i++) {
		var cmd = "k " + strSet + " " + i;
		application.activeWindow.command(cmd, false);
		str7100 = application.activeWindow.title.findTag("7100", 0, true, true, true);

		for (var tag in ddcMap) {
			var notationList = ddcMap[tag];	// sorted array
			var currentRecordFieldEntry = application.activeWindow.title.findTag(tag, 0, true, true, true);
			var currentRecordFieldValue = currentRecordFieldEntry.substring(5);
			
		//	application.activeWindow.title.insertText("current record field val: " + currentRecordFieldValue);

			var currentRecordFieldValueSplits = currentRecordFieldValue.split(";");
			for (var split in currentRecordFieldValueSplits) {
				var currentRecordDDCKey = currentRecordFieldValueSplits[split].trim();

				// perform exact matching first, skip partial matching if successful
				if (ddcIxTheoMatchHierarchy(str7100, notationList, currentRecordDDCKey, false))
					continue;

				// perform partial matching next
				ddcIxTheoMatchHierarchy(str7100, notationList, currentRecordDDCKey, true);
			}
		}

		application.activeWindow.pressButton("Enter");
	}
}
